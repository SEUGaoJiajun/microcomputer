NAME	OUTPUT_CLOCK
DATA SEGMENT
BUFFER  DB 11
	DB ?
	DB 10 DUP(?)
DATA ENDS
CODE SEGMENT
 ASSUME CS:CODE,DS:DATA
BEGIN: MOV AX,DATA
	MOV DS,AX
	MOV DL,':'
	MOV AH,2
	INT 21H
	MOV DX,OFFSET BUFFER
	MOV AH,0AH
	INT 21H
        MOV BX,OFFSET BUFFER+2
	MOV AL,[BX]
	AND AL,0FH
	MOV [BX],AL
	INC BX
	MOV AL,[BX]
	AND AL,0FH
	MOV [BX],AL
	INC BX
	INC BX
	MOV AL,[BX]
	AND AL,0FH
	MOV [BX],AL
	INC BX
	MOV AL,[BX]
	AND AL,0FH
	MOV [BX],AL
	INC BX
	INC BX
	MOV AL,[BX]
	AND AL,0FH
	MOV [BX],AL
	INC BX
	MOV AL,[BX]
	AND AL,0FH
	MOV [BX],AL
	MOV BX,OFFSET BUFFER+2
	CALL TOBCD
	MOV CH,AL
	ADD BX,3
	CALL TOBCD
	MOV DH,AL
	ADD BX,3
	CALL TOBCD
	MOV DL,AL
	
AGAIN:  PUSH CX
	MOV CX,0FFFFH
C:	CALL DELAY
	LOOP C
	POP CX
	MOV AL,DL
	ADD AL,1
	DAA
	MOV DL,AL
	CMP AL,60H
	JNE DISPY
	MOV DL,0
	MOV AL,DH
	ADD AL,1
	DAA
	MOV DH,AL
	CMP AL,60H
	JNE DISPY
	MOV DH,0
	MOV AL,CH
	ADD AL,1
	DAA
	MOV CH,AL
	CMP AL,24H
	JNE DISPY
	MOV CH,0
DISPY:MOV BX,OFFSET STIME+2
	MOV AL,CH
	CALL TOA
	INC BX
	MOV AL,':'
	MOV [BX],AL
	INC BX
	MOV AL,DH
	CALL TOA
	INC BX
	MOV AL,':'
	MOV [BX],AL
	INC BX							//前有一句MOV [BX],AL
	MOV AL,DL
	CALL TOA
	PUSH BX
	PUSH CX
	PUSH DX
	MOV DX,OFFSET STIME
	MOV AH,9
	INT 21H
	MOV AH,06H
	MOV DL,0FFH
	INT 21H
	JNZ OVER
	POP DX
	POP CX
	POP BX									//放在出栈之前
	JMP AGAIN
OVER:MOV AH,4CH
   INT 21H
TOBCD PROC
	MOV AL,[BX]
	SHL AL,1
	SHL AL,1
	SHL AL,1
	SHL AL,1
	0R AL,[BX+1]
	RET
TOBCD ENDP
TOA PROC
	MOV CL,AL
	SHR AL,1
	SHR AL,1
	SHR AL,1
	SHR AL,1
	OR AL,30H
	MOV [BX],AL
	INC BX
	MOV AL,CL
	AND AL,0FH
	OR AL,30H
	MOV [BX],AL
	RET
TOA ENDP
DELAY PROC
	PUSH CX
	PUSH AX
	MOV CX,0FFFFH
GOON:DEC CX
	JNE GOON
	POP AX
	POP CX
	RET
DELAY ENDP
CODE ENDS
	END BEGIN
